<div class="login-page">
  <div class="login-card">
    <img
      src="assets/Agdata_logo.png"
      alt="AGDATA Logo"
      style="height: 80px; width: 250px"
      class="brand-logo"
    />

    <div class="login-box">
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <h2>Login</h2>

        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" type="email" formControlName="email" placeholder="" maxlength="255" />

          @if (form.get('email')?.invalid && form.get('email')?.touched) {
            <div class="error">
              @if (form.get('email')?.errors?.['required']) {
                <span>Email is required</span><br />
              }
              @if (form.get('email')?.errors?.['email']) {
                <span>Invalid email format</span>
              }
              @if (form.get('email')?.errors?.['maxlength']) {
                <span>Email cannot exceed 255 characters</span>
              }
              @if (form.get('email')?.errors?.['agdataEmail']) {
                <span> Only @agdata.com email can login</span>
              }
            </div>
          }
        </div>

        <div class="form-group">
          <label for="password">Password</label>

          <div class="password-wrapper">
            <input
              id="password"
              [type]="showPassword ? 'text' : 'password'"
              formControlName="password"
              placeholder=""
            />

            <button
              type="button"
              class="toggle-password"
              (click)="togglePassword()"
              [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'"
            >
              <!-- Simple eye icon using text. You can replace with SVG/FontAwesome -->
              <span class="eye">{{ showPassword ? 'üôà' : 'üëÅÔ∏è' }}</span>
            </button>
          </div>

          @let pwd = form.get('password');
          @if (pwd?.invalid && pwd?.touched) {
            <div class="error">
              @if (pwd?.errors?.['required']) {
                <span>Password is required</span>
              }
              @if (pwd?.errors?.['minlength']) {
                <span>Password must be at least 8 characters</span>
              }
            </div>
          }
        </div>

        <!-- Show all validation errors from backend -->
        @if (validationErrors().length > 0) {
          <div class="error-list">
            @for (error of validationErrors(); track error) {
              <div class="error">{{ error }}</div>
            }
          </div>
        }

        <!-- Fallback single error message -->
        @if (errorMsg() && validationErrors().length === 0) {
          <div class="error">{{ errorMsg() }}</div>
        }

        <button class="login-btn" type="submit" [disabled]="loading()">
          {{ loading() ? 'Signing in...' : 'Login' }}
        </button>

        <!-- <a class="forgot-link" href="#">Forgot password?</a> -->
      </form>
    </div>

    <div class="footer-links">
      <!-- <a href="#">About</a>
      <a href="#">Privacy Policy</a> -->
    </div>
  </div>
</div>
