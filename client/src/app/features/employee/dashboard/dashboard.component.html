<div class="employee-dashboard">
  <!-- Header Section -->
  <div class="dashboard-header">
    <h1 class="dashboard-title">Welcome back, {{ userName }}!</h1>
    <p class="dashboard-subtitle">Here's your rewards summary</p>
  </div>

  <!-- Points Balance Section -->
  <div class="points-balance-section">
    <div class="balance-card main-balance">
      <div class="balance-icon"><app-icon name="trophy" [size]="28"></app-icon></div>
      <div class="balance-info">
        <span class="balance-label">Total Points</span>
        <span class="balance-value">{{ pointsBalance().total }}</span>
      </div>
    </div>

    <div class="balance-card">
      <div class="balance-icon available"><app-icon name="wallet" [size]="28"></app-icon></div>
      <div class="balance-info">
        <span class="balance-label">Available Points</span>
        <span class="balance-value">{{ pointsBalance().available }}</span>
      </div>
    </div>

    <div class="balance-card">
      <div class="balance-icon pending"><app-icon name="pending" [size]="28"></app-icon></div>
      <div class="balance-info">
        <span class="balance-label">Pending Points</span>
        <span class="balance-value">{{ pointsBalance().pending }}</span>
      </div>
    </div>

    <div class="balance-card">
      <div class="balance-icon redeemed"><app-icon name="gift" [size]="28"></app-icon></div>
      <div class="balance-info">
        <span class="balance-label">Redeemed Points</span>
        <span class="balance-value">{{ pointsBalance().redeemed }}</span>
      </div>
    </div>
  </div>

  <!-- My Redemptions Summary Section -->
  <div class="redemptions-summary-section">
    <div class="section-header">
      <h2 class="section-title"><app-icon name="cart" [size]="20"></app-icon> My Redemptions</h2>
      <button class="view-all-btn" (click)="navigateToAccount()">View All <app-icon name="chevron-right" [size]="14"></app-icon></button>
    </div>
    <div class="redemptions-summary-grid">
      <div class="redemption-stat pending-stat">
        <div class="redemption-icon"><app-icon name="pending" [size]="24"></app-icon></div>
        <div class="redemption-content">
          <span class="redemption-label">Pending</span>
          <span class="redemption-value">{{ redemptionsSummary().pending }}</span>
        </div>
      </div>
      <div class="redemption-stat approved-stat">
        <div class="redemption-icon"><app-icon name="check-circle" [size]="24"></app-icon></div>
        <div class="redemption-content">
          <span class="redemption-label">Approved</span>
          <span class="redemption-value">{{ redemptionsSummary().approved }}</span>
        </div>
      </div>
      <div class="redemption-stat delivered-stat">
        <div class="redemption-icon"><app-icon name="gift" [size]="24"></app-icon></div>
        <div class="redemption-content">
          <span class="redemption-label">Delivered</span>
          <span class="redemption-value">{{ redemptionsSummary().delivered }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Two Column Layout -->
  <div class="dashboard-grid">
    <!-- Left Column -->
    <div class="dashboard-column">
      <!-- Upcoming Events -->
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title"><app-icon name="celebrate" [size]="20"></app-icon> Upcoming Events</h2>
          <button class="view-all-btn" (click)="navigateToEvents()">View All <app-icon name="chevron-right" [size]="14"></app-icon></button>
        </div>

        <div class="events-list">
          @for (event of upcomingEvents(); track event.id) {
            <div class="event-item">
              <img [src]="event.image" [alt]="event.name" class="event-image" />
              <div class="event-details">
                <h3 class="event-name">{{ event.name }}</h3>
                <p class="event-meta">
                  <span class="event-date"><app-icon name="calendar" [size]="14"></app-icon> {{ event.date }}</span>
                  <span class="event-location"><app-icon name="location" [size]="14"></app-icon> {{ event.location }}</span>
                </p>
                <div class="event-footer">
                  <span class="event-points">+{{ event.points }} points</span>
                  @if (!event.registered) {
                    <button
                      class="register-btn"
                      (click)="registerForEvent(event)"
                    >
                      Register
                    </button>
                  } @else {
                    <span class="registered-badge"><app-icon name="check" [size]="14"></app-icon> Registered</span>
                  }
                </div>
              </div>
            </div>
          }

          @if (upcomingEvents().length === 0 && !isLoading()) {
            <div class="empty-state">
              <p>No upcoming events at the moment</p>
            </div>
          }
        </div>
      </div>

      <!-- Featured Products -->
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title"><app-icon name="gift" [size]="20"></app-icon> Featured Products</h2>
          <button class="view-all-btn" (click)="navigateToProducts()">View All <app-icon name="chevron-right" [size]="14"></app-icon></button>
        </div>

        <div class="products-grid">
          @for (product of featuredProducts(); track product.id) {
            <div class="product-card">
              <img [src]="product.image" [alt]="product.name" class="product-image" />
              <div class="product-info">
                <span class="product-category">{{ product.category }}</span>
                <h3 class="product-name">{{ product.name }}</h3>
                <div class="product-footer">
                  <span class="product-points">{{ product.points }} pts</span>
                  <span
                    class="product-stock"
                    [class.low-stock]="product.stock < 10"
                  >
                    {{ product.stock }} left
                  </span>
                </div>
                <button
                  class="redeem-btn"
                  [disabled]="pointsBalance().available < product.points"
                  (click)="redeemProduct(product)"
                >
                  {{ pointsBalance().available >= product.points ? 'Redeem' : 'Insufficient Points' }}
                </button>
              </div>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Right Column -->
    <div class="dashboard-column">
      <!-- Recent Transactions -->
      <div class="section-card transactions-card">
        <div class="section-header">
          <h2 class="section-title"><app-icon name="wallet" [size]="20"></app-icon> Recent Transactions</h2>
          <button class="view-all-btn" (click)="navigateToAccount()">View All <app-icon name="chevron-right" [size]="14"></app-icon></button>
        </div>

        <div class="transactions-list">
          @for (transaction of recentTransactions(); track transaction.id) {
            <div
              class="transaction-item"
              [class.earned]="transaction.type === 'earned'"
              [class.redeemed]="transaction.type === 'redeemed'"
            >
              <div class="transaction-icon-wrapper" [class.earned]="transaction.type === 'earned'" [class.redeemed]="transaction.type === 'redeemed'">
                @if (transaction.type === 'earned') {
                  <app-icon name="trending-up" [size]="20"></app-icon>
                }
                @if (transaction.type === 'redeemed') {
                  <app-icon name="shopping-cart" [size]="20"></app-icon>
                }
              </div>
              <div class="transaction-details">
                <span class="transaction-description">{{ transaction.description }}</span>
                <div class="transaction-meta">
                  <span class="transaction-date">{{ transaction.date }}</span>
                  @if (transaction.source) {
                    <span class="transaction-source" [class]="'source-' + transaction.source.toLowerCase()">
                      {{ transaction.source }}
                    </span>
                  }
                </div>
                @if (transaction.eventName) {
                  <div class="transaction-event">
                    <span class="event-name"><app-icon name="celebrate" [size]="14"></app-icon> {{ transaction.eventName }}</span>
                    @if (transaction.eventRank) {
                      <span class="event-rank"><app-icon name="trophy" [size]="14"></app-icon> #{{ transaction.eventRank }}</span>
                    }
                  </div>
                }
              </div>
              <div class="transaction-amount" 
                   [class.positive]="transaction.points > 0"
                   [class.negative]="transaction.points < 0">
                {{ transaction.points > 0 ? '+' : '' }}{{ transaction.points }}
              </div>
            </div>
          }

          @if (recentTransactions().length === 0 && !isLoading()) {
            <div class="empty-state">
              <p>No transactions yet</p>
            </div>
          }
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="section-card quick-actions-card">
        <h2 class="section-title"><app-icon name="flash" [size]="20"></app-icon> Quick Actions</h2>
        <div class="quick-actions">
          <button class="action-btn" (click)="navigateToEvents()">
            <span class="action-icon"><app-icon name="celebrate" [size]="24"></app-icon></span>
            <span class="action-text">Browse Events</span>
          </button>
          <button class="action-btn" (click)="navigateToProducts()">
            <span class="action-icon"><app-icon name="shopping-cart" [size]="24"></app-icon></span>
            <span class="action-text">Shop Products</span>
          </button>
          <button class="action-btn" (click)="navigateToAccount()">
            <span class="action-icon"><app-icon name="chart-bar" [size]="24"></app-icon></span>
            <span class="action-text">View History</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
