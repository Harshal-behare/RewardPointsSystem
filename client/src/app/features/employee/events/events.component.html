<div class="employee-events">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">ğŸ‰ Events</h1>
      <p class="page-subtitle">Discover and register for exciting company events</p>
    </div>
  </div>

  <!-- Filters & Search -->
  <div class="filters-section">
    <div class="filter-tabs">
      <button
        class="filter-tab"
        [class.active]="selectedFilter === 'all'"
        (click)="onFilterChange('all')"
      >
        All Events
      </button>
      <button
        class="filter-tab"
        [class.active]="selectedFilter === 'upcoming'"
        (click)="onFilterChange('upcoming')"
      >
        Upcoming
      </button>
      <button
        class="filter-tab"
        [class.active]="selectedFilter === 'ongoing'"
        (click)="onFilterChange('ongoing')"
      >
        Ongoing
      </button>
      <button
        class="filter-tab"
        [class.active]="selectedFilter === 'completed'"
        (click)="onFilterChange('completed')"
      >
        Completed
      </button>
    </div>

    <div class="search-box">
      <input
        type="text"
        placeholder="Search events..."
        [(ngModel)]="searchQuery"
        (input)="onSearchChange()"
        class="search-input"
      />
      <span class="search-icon">ğŸ”</span>
    </div>
  </div>

  <!-- Events Grid -->
  <div class="events-grid">
    <div *ngFor="let event of filteredEvents" class="event-card">
      <div class="event-image-container">
        <img [src]="event.image" [alt]="event.name" class="event-image" />
        <span class="event-badge" [ngClass]="getStatusBadgeClass(event.status)">
          {{ getStatusLabel(event.status) }}
        </span>
        <span class="event-category">{{ event.category }}</span>
      </div>

      <div class="event-content">
        <h3 class="event-title">{{ event.name }}</h3>
        <p class="event-description">{{ event.description }}</p>

        <div class="event-meta">
          <div class="meta-item">
            <span class="meta-icon">ğŸ“…</span>
            <span class="meta-text">{{ event.date }}</span>
          </div>
          <div class="meta-item">
            <span class="meta-icon">ğŸ“</span>
            <span class="meta-text">{{ event.location }}</span>
          </div>
          <div class="meta-item">
            <span class="meta-icon">ğŸ‘¥</span>
            <span class="meta-text">
              {{ event.currentParticipants }} / {{ event.maxParticipants }} participants
            </span>
          </div>
        </div>

        <!-- Availability Bar -->
        <div class="availability-bar">
          <div
            class="availability-fill"
            [style.width.%]="getAvailabilityPercentage(event)"
            [class.full]="isEventFull(event)"
          ></div>
        </div>

        <div class="event-footer">
          <span class="event-points">+{{ event.points }} points</span>

          <div class="event-actions">
            <button class="action-btn details-btn" (click)="openDetailsModal(event)">
              View Details
            </button>

            <button
              *ngIf="!event.registered && event.status === 'upcoming'"
              class="action-btn register-btn"
              [disabled]="isEventFull(event)"
              (click)="registerForEvent(event)"
            >
              {{ isEventFull(event) ? 'Event Full' : 'Register' }}
            </button>

            <button
              *ngIf="event.registered && event.status === 'upcoming'"
              class="action-btn unregister-btn"
              (click)="unregisterFromEvent(event)"
            >
              Unregister
            </button>

            <span *ngIf="event.registered && event.status !== 'upcoming'" class="registered-badge">
              âœ“ Registered
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="filteredEvents.length === 0" class="empty-state">
    <span class="empty-icon">ğŸ”</span>
    <h3>No events found</h3>
    <p>Try adjusting your filters or search query</p>
  </div>
</div>

<!-- Event Details Modal -->
<div *ngIf="showDetailsModal && selectedEvent" class="modal-overlay" (click)="closeDetailsModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">{{ selectedEvent.name }}</h2>
      <button class="close-btn" (click)="closeDetailsModal()">âœ•</button>
    </div>

    <div class="modal-body">
      <img [src]="selectedEvent.image" [alt]="selectedEvent.name" class="modal-event-image" />

      <div class="modal-event-info">
        <div class="info-section">
          <h3 class="info-title">Description</h3>
          <p class="info-text">{{ selectedEvent.description }}</p>
        </div>

        <div class="info-section">
          <h3 class="info-title">Event Details</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">ğŸ“… Date:</span>
              <span class="info-value">{{ selectedEvent.date }}</span>
            </div>
            <div class="info-item" *ngIf="selectedEvent.endDate">
              <span class="info-label">ğŸ“… End Date:</span>
              <span class="info-value">{{ selectedEvent.endDate }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">ğŸ“ Location:</span>
              <span class="info-value">{{ selectedEvent.location }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">ğŸ‘¥ Participants:</span>
              <span class="info-value">
                {{ selectedEvent.currentParticipants }} / {{ selectedEvent.maxParticipants }}
              </span>
            </div>
            <div class="info-item">
              <span class="info-label">ğŸ† Reward:</span>
              <span class="info-value">{{ selectedEvent.points }} points</span>
            </div>
            <div class="info-item">
              <span class="info-label">ğŸ“‚ Category:</span>
              <span class="info-value">{{ selectedEvent.category }}</span>
            </div>
          </div>
        </div>

        <div class="info-section">
          <div class="status-badge-large" [ngClass]="getStatusBadgeClass(selectedEvent.status)">
            Status: {{ getStatusLabel(selectedEvent.status) }}
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="modal-btn cancel-btn" (click)="closeDetailsModal()">Close</button>

      <button
        *ngIf="!selectedEvent.registered && selectedEvent.status === 'upcoming'"
        class="modal-btn register-btn"
        [disabled]="isEventFull(selectedEvent)"
        (click)="registerForEvent(selectedEvent); closeDetailsModal()"
      >
        {{ isEventFull(selectedEvent) ? 'Event Full' : 'Register Now' }}
      </button>

      <button
        *ngIf="selectedEvent.registered && selectedEvent.status === 'upcoming'"
        class="modal-btn unregister-btn"
        (click)="unregisterFromEvent(selectedEvent); closeDetailsModal()"
      >
        Unregister
      </button>
    </div>
  </div>
</div>
